<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© - Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª</title>
    <style>
        :root { --accent: #e74c3c; --bg: #1a1a1a; --success: #27ae60; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; padding: 15px; color: #333; }
        .container { width: 100%; max-width: 500px; margin: auto; background: white; padding: 20px; border-radius: 30px; }
        .header { text-align: center; margin-bottom: 20px; }
        .header h1 { font-size: 22px; margin: 0; }
        .pending-card { background: #f9f9f9; border-radius: 20px; padding: 15px; margin-bottom: 15px; border: 1px solid #eee; position: relative; }
        .info { font-size: 13px; margin-bottom: 5px; }
        .info b { color: var(--accent); }
        .btn-approve { width: 100%; background: var(--success); color: white; border: none; padding: 12px; border-radius: 12px; font-weight: bold; cursor: pointer; margin-top: 10px; }
        .btn-approve:disabled { background: #ccc; }
        #status { text-align: center; font-weight: bold; margin-bottom: 10px; font-size: 14px; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©</h1>
        <p style="font-size: 12px; color: #666;">ÙˆØ±Ù‚Ø© Pending</p>
    </div>

    <div id="status">ğŸ”„ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª...</div>
    <div id="pendingList"></div>
</div>

<script>
    // Ø±Ø§Ø¨Ø· CSV Ù„ÙˆØ±Ù‚Ø© Pending ÙÙ‚Ø·
    const pendingUrl = 'https://docs.google.com/spreadsheets/d/e/YOUR_ID/pub?gid=YOUR_PENDING_GID&single=true&output=csv';
    const scriptUrl = 'YOUR_APPS_SCRIPT_WEB_APP_URL';

    async function loadPending() {
        try {
            const res = await fetch(pendingUrl + "&t=" + new Date().getTime());
            const text = await res.text();
            const rows = text.split('\n').slice(1).map(row => row.split(','));
            
            const list = document.getElementById('pendingList');
            const status = document.getElementById('status');
            list.innerHTML = "";

            if (rows.length === 0 || rows[0].length < 2) {
                status.innerHTML = "âœ… Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ù…Ø¹Ù„Ù‚Ø© Ø­Ø§Ù„ÙŠØ§Ù‹";
                return;
            }

            status.innerHTML = `ÙŠÙˆØ¬Ø¯ (${rows.length}) Ø·Ù„Ø¨Ø§Øª Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©`;

            rows.forEach((row, index) => {
                if (!row[4]) return; // ØªØ®Ø·ÙŠ Ø§Ù„Ø³Ø·ÙˆØ± Ø§Ù„ÙØ§Ø±ØºØ©
                const div = document.createElement('div');
                div.className = 'pending-card';
                div.innerHTML = `
                    <div class="info"><b>Ø§Ù„Ø¬Ù‡Ø§Ø²:</b> ${row[1]} ${row[2]}</div>
                    <div class="info"><b>IMEI:</b> ${row[4]}</div>
                    <div class="info"><b>Ø§Ù„Ù…Ø§Ù„Ùƒ:</b> ${row[6]}</div>
                    <button class="btn-approve" onclick="approveRow(${index + 2}, this)">âœ… Ù…ÙˆØ§ÙÙ‚Ø© ÙˆÙ†Ù‚Ù„ Ù„Ù„Ù‚Ø§Ø¦Ù…Ø©</button>
                `;
                list.appendChild(div);
            });
        } catch (e) {
            document.getElementById('status').innerHTML = "ğŸ”´ ÙØ´Ù„ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª";
        }
    }

    async function approveRow(rowNum, btn) {
        btn.disabled = true;
        btn.innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù†Ù‚Ù„...";
        
        // Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø§Ù„Ø³ÙƒØ±ÙŠØ¨Øª Ù„ÙŠØ¶Ø¹ "Ù†Ø¹Ù…" ÙÙŠ Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ ÙˆÙŠÙ‚ÙˆÙ… Ø¨Ø§Ù„Ù†Ù‚Ù„
        try {
            await fetch(`${scriptUrl}?action=approve&row=${rowNum}`);
            btn.parentElement.style.display = 'none';
            alert("ØªÙ… Ù†Ù‚Ù„ Ø§Ù„Ø¨Ù„Ø§Øº Ø¨Ù†Ø¬Ø§Ø­!");
        } catch (e) {
            alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ù†Ù‚Ù„");
            btn.disabled = false;
        }
    }

    loadPending();
</script>
</body>
</html>
