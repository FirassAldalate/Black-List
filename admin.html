<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© - Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª</title>
    <style>
        :root { --accent: #e74c3c; --bg: #1a1a1a; --success: #27ae60; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--bg); margin: 0; padding: 15px; display: flex; justify-content: center; }
        .container { width: 100%; max-width: 450px; background: white; padding: 25px; border-radius: 30px; box-shadow: 0 15px 50px rgba(0,0,0,0.3); }
        .header { text-align: center; margin-bottom: 20px; border-bottom: 2px solid #eee; padding-bottom: 10px; }
        .header h1 { font-size: 22px; margin: 0; color: #000; }
        
        #status { text-align: center; font-size: 13px; font-weight: bold; margin-bottom: 15px; color: #666; }
        
        .pending-card { background: #fff; border-radius: 20px; padding: 18px; margin-bottom: 15px; border: 1px solid #eee; box-shadow: 0 5px 15px rgba(0,0,0,0.05); animation: fadeIn 0.5s ease; }
        .info-item { margin-bottom: 8px; font-size: 14px; display: flex; justify-content: space-between; border-bottom: 1px dashed #f0f0f0; padding-bottom: 5px; flex-direction: row-reverse; }
        .info-item b { color: var(--accent); min-width: 80px; text-align: left; }
        .info-item span { color: #333; font-weight: 600; text-align: right; }

        .btn-approve { width: 100%; background: var(--success); color: white; border: none; padding: 15px; border-radius: 15px; font-size: 16px; font-weight: bold; cursor: pointer; margin-top: 10px; transition: 0.3s; }
        .btn-approve:active { transform: scale(0.95); }
        .btn-approve:disabled { background: #ccc; cursor: not-allowed; }

        /* Ø³ØªØ§ÙŠÙ„ Ø´Ø§Ø´Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ */
        #loginOverlay { position:fixed; top:0; left:0; width:100%; height:100%; background:var(--bg); z-index:1000; display:flex; justify-content:center; align-items:center; }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div id="loginOverlay">
    <div class="container" style="max-width:320px; text-align:center;">
        <h2 style="margin-bottom:10px;">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h2>
        <input type="password" id="passInput" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" style="width:100%; padding:12px; border-radius:10px; border:1px solid #ddd; margin-bottom:15px; text-align:center; box-sizing:border-box;">
        <button onclick="checkLogin()" style="width:100%; background:#000; color:#fff; border:none; padding:12px; border-radius:10px; font-weight:bold;">Ø¯Ø®ÙˆÙ„</button>
        <p id="loginError" style="color:red; font-size:12px; margin-top:10px; font-weight:bold;"></p>
    </div>
</div>

<div class="container">
    <div class="header">
        <h1>Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©</h1>
    </div>

    <div id="status">ğŸ”„ Ø¬Ø§Ø±ÙŠ ÙØ­Øµ Ø§Ù„Ø·Ù„Ø¨Ø§Øª...</div>
    <div id="pendingList"></div>
    
    <a href="index.html" style="display:block; text-align:center; margin-top:20px; color:#888; text-decoration:none; font-size:13px;">â¬…ï¸ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
</div>

<script>
    // Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ
    const pendingUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSF5W0EW-E_36UGUSpTWJkXx7gaLqjUbyz90syivKGp9D4GFWIm_yQmQxaNo_2lUmN1pM0BjH4bQPnI/pub?gid=341654715&single=true&output=csv';
    const scriptUrl = 'https://script.google.com/macros/s/AKfycbyS8x7lZ40mEzbgP3tOw56ZxHnCd2XUk2dC7vdbma4J8zVDlkUkrSgivf3HApBowocjSg/exec';
    
    // ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ù„Ø¯Ø®ÙˆÙ„ Ù„ØµÙØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© (ÙŠÙ…ÙƒÙ†Ùƒ ØªØºÙŠÙŠØ±Ù‡Ø§)
    const ADMIN_PASS = "123456"; 

    function checkLogin() {
        const input = document.getElementById('passInput').value;
        if (input === ADMIN_PASS) {
            document.getElementById('loginOverlay').style.display = 'none';
            loadPending();
        } else {
            document.getElementById('loginError').innerText = "âŒ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©";
        }
    }

    async function loadPending() {
        const listDiv = document.getElementById('pendingList');
        const statusDiv = document.getElementById('status');
        
        try {
            const response = await fetch(pendingUrl + "&nocache=" + new Date().getTime());
            const data = await response.text();
            const rows = data.split('\n').filter(row => row.trim() !== '').map(row => 
                row.split(',').map(cell => cell.replace(/^"(.*)"$/, '$1').trim())
            );

            listDiv.innerHTML = "";

            if (rows.length <= 1) {
                statusDiv.innerHTML = "âœ… Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© Ø­Ø§Ù„ÙŠØ§Ù‹";
                listDiv.innerHTML = '<div style="text-align:center; padding:40px; color:#888; font-weight:bold;">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± ÙØ§Ø±ØºØ© ğŸ‘</div>';
                return;
            }

            statusDiv.innerHTML = `ÙŠÙˆØ¬Ø¯ (${rows.length - 1}) Ø¨Ù„Ø§ØºØ§Øª Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©`;

            for (let i = 1; i < rows.length; i++) {
                const row = rows[i];
                if (!row[4]) continue; 

                const card = document.createElement('div');
                card.className = 'pending-card';
                card.innerHTML = `
                    <div class="info-item"><b>Ø§Ù„Ø´Ø±ÙƒØ©:</b> <span>${row[1] || '---'}</span></div>
                    <div class="info-item"><b>Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„:</b> <span>${row[2] || '---'}</span></div>
                    <div class="info-item"><b>Ø§Ù„Ù„ÙˆÙ†:</b> <span>${row[3] || '---'}</span></div>
                    <div class="info-item"><b>IMEI:</b> <span>${row[4] || '---'}</span></div>
                    <div class="info-item"><b>Ø§Ù„Ù…Ø§Ù„Ùƒ:</b> <span>${row[6] || '---'}</span></div>
                    <button class="btn-approve" onclick="approveEntry(${i + 1}, this)">âœ… Ù…ÙˆØ§ÙÙ‚Ø© ÙˆÙ†Ù‚Ù„ Ø§Ù„Ø¢Ù†</button>
                `;
                listDiv.appendChild(card);
            }
        } catch (error) {
            statusDiv.innerHTML = "ğŸ”´ Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø´ÙŠØª";
        }
    }

    async function approveEntry(rowNumber, btn) {
        if (!confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù†Ù‚Ù„ Ù‡Ø°Ø§ Ø§Ù„Ø¨Ù„Ø§Øº Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©ØŸ")) return;
        
        btn.disabled = true;
        btn.innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù†Ù‚Ù„...";
        
        try {
            // Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ù„Ù„Ø³ÙŠØ±ÙØ±
            await fetch(`${scriptUrl}?action=approve&row=${rowNumber}`, { mode: 'no-cors' });
            
            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© ÙˆØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØ© ÙˆÙ†ØµÙ
            setTimeout(() => {
                btn.parentElement.style.opacity = '0.5';
                btn.innerText = "âœ”ï¸ ØªÙ… Ø§Ù„Ù†Ù‚Ù„";
                loadPending();
            }, 1500);
            
        } catch (error) {
            alert("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±");
            btn.disabled = false;
            btn.innerText = "âœ… Ù…ÙˆØ§ÙÙ‚Ø© ÙˆÙ†Ù‚Ù„ Ø§Ù„Ø¢Ù†";
        }
    }
</script>
</body>
</html>
